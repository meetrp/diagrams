<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2951px" preserveAspectRatio="none" style="width:1730px;height:2951px;background:#FFFFFF;" version="1.1" viewBox="0 0 1730 2951" width="1730px" zoomAndPan="magnify"><defs><filter height="300%" id="f1zkq0s83i0iy" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="771" x="476" y="58.7021">[oauth 2.0] Authorization Code Grant flow (server to server)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="324" x="699.5" y="74.1011">User wants to expose all his contacts to "MyApp Server."</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="381" x="671" y="86.9058">"MyApp Server" presents a page with all possible resource servers</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="241" x="741" y="99.7104">(like GMail/FB). User chooses one of them.</text><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="101.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="344.5" y="1099.0859"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="349.5" y="1136.2188"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="34.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="344.5" y="1501.0781"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="2270.8203" style="stroke:#A80036;stroke-width:1.0;" width="10" x="545.5" y="562.4297"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="144.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="891.5" y="591.5625"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="860.9141" style="stroke:#A80036;stroke-width:1.0;" width="10" x="891.5" y="1943.2031"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="74.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="367.8281"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="173.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="896.5547"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="933.6875"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="1005.8203"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="146.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="1274.8828"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="1312.0156"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="264.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="1564.3438"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="1631.7422"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="1703.875"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="406.4258" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="2093.3984"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="2130.5313"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="2232.9297"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="2318.6953"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="2716.7188"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="132.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1577.5" y="2642.1875"/><rect fill="#E0FFFF" filter="url(#f1zkq0s83i0iy)" height="181.3281" style="stroke:#000000;stroke-width:2.0;" width="555" x="797.5" y="269.0313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="349" x2="349" y1="208.8984" y2="457.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="349" x2="349" y1="457.3594" y2="498.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="349" x2="349" y1="498.1641" y2="2851.25"/><line style="stroke:#A80036;stroke-width:1.0;" x1="550.5" x2="550.5" y1="208.8984" y2="457.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="550.5" x2="550.5" y1="457.3594" y2="498.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="550.5" x2="550.5" y1="498.1641" y2="2851.25"/><line style="stroke:#A80036;stroke-width:1.0;" x1="896.5" x2="896.5" y1="208.8984" y2="457.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="896.5" x2="896.5" y1="457.3594" y2="498.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="896.5" x2="896.5" y1="498.1641" y2="2851.25"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1251.5" x2="1251.5" y1="208.8984" y2="457.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1251.5" x2="1251.5" y1="457.3594" y2="498.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1251.5" x2="1251.5" y1="498.1641" y2="2851.25"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1582" x2="1582" y1="208.8984" y2="457.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1582" x2="1582" y1="457.3594" y2="498.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1582" x2="1582" y1="498.1641" y2="2851.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="135" x="279" y="189.2998">«Resource Owner»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="331" y="205.5967">User</text><ellipse cx="349.5" cy="119.3047" fill="#C2F0FF" filter="url(#f1zkq0s83i0iy)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M349.5,127.3047 L349.5,154.3047 M336.5,135.3047 L362.5,135.3047 M349.5,154.3047 L336.5,169.3047 M349.5,154.3047 L362.5,169.3047 " fill="none" filter="url(#f1zkq0s83i0iy)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="135" x="279" y="2863.2451">«Resource Owner»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="331" y="2879.542">User</text><ellipse cx="349.5" cy="2892.8438" fill="#C2F0FF" filter="url(#f1zkq0s83i0iy)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M349.5,2900.8438 L349.5,2927.8438 M336.5,2908.8438 L362.5,2908.8438 M349.5,2927.8438 L336.5,2942.8438 M349.5,2927.8438 L362.5,2942.8438 " fill="none" filter="url(#f1zkq0s83i0iy)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#C2F0FF" filter="url(#f1zkq0s83i0iy)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="110" x="493.5" y="157.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="96" x="500.5" y="177.2998">«User Agent»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="501" y="193.5967">Web Browser</text><rect fill="#C2F0FF" filter="url(#f1zkq0s83i0iy)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="110" x="493.5" y="2850.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="96" x="500.5" y="2870.2451">«User Agent»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="501" y="2886.542">Web Browser</text><rect fill="#FFE0E0" filter="url(#f1zkq0s83i0iy)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="174" x="807.5" y="157.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="160" x="814.5" y="177.2998">«Client / Redirect URI»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="844" y="193.5967">MyApp Server</text><rect fill="#FFE0E0" filter="url(#f1zkq0s83i0iy)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="174" x="807.5" y="2850.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="160" x="814.5" y="2870.2451">«Client / Redirect URI»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="844" y="2886.542">MyApp Server</text><rect fill="#C9FFC9" filter="url(#f1zkq0s83i0iy)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="178" x="1160.5" y="157.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="164" x="1167.5" y="177.2998">«Authorization Server»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="1193" y="193.5967">GMail/FB Server</text><rect fill="#C9FFC9" filter="url(#f1zkq0s83i0iy)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="178" x="1160.5" y="2850.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="164" x="1167.5" y="2870.2451">«Authorization Server»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="1193" y="2886.542">GMail/FB Server</text><rect fill="#F8E7C0" filter="url(#f1zkq0s83i0iy)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="267" x="1447" y="157.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="136" x="1512.5" y="177.2998">«Resource Server»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="253" x="1454" y="193.5967">Google Contacts API/FB Friends API</text><rect fill="#F8E7C0" filter="url(#f1zkq0s83i0iy)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="267" x="1447" y="2850.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="136" x="1512.5" y="2870.2451">«Resource Server»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="253" x="1454" y="2886.542">Google Contacts API/FB Friends API</text><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="101.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="344.5" y="1099.0859"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="349.5" y="1136.2188"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="34.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="344.5" y="1501.0781"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="2270.8203" style="stroke:#A80036;stroke-width:1.0;" width="10" x="545.5" y="562.4297"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="144.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="891.5" y="591.5625"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="860.9141" style="stroke:#A80036;stroke-width:1.0;" width="10" x="891.5" y="1943.2031"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="74.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="367.8281"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="173.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="896.5547"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="933.6875"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="1005.8203"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="146.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="1274.8828"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="1312.0156"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="264.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="1564.3438"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="1631.7422"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="1703.875"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="406.4258" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="2093.3984"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="2130.5313"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="2232.9297"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="2318.6953"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1246.5" y="2716.7188"/><rect fill="#FFFFFF" filter="url(#f1zkq0s83i0iy)" height="132.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1577.5" y="2642.1875"/><rect fill="#EEEEEE" filter="url(#f1zkq0s83i0iy)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1723" x="0" y="239.4648"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1723" y1="239.4648" y2="239.4648"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1723" y1="242.4648" y2="242.4648"/><rect fill="#EEEEEE" filter="url(#f1zkq0s83i0iy)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="163" x="780" y="228.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="786" y="244.9653">Client Registration</text><path d="M797.5,269.0313 L1002.5,269.0313 L1002.5,276.0313 L992.5,286.0313 L797.5,286.0313 L797.5,269.0313 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="181.3281" style="stroke:#000000;stroke-width:2.0;" width="555" x="797.5" y="269.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="160" x="812.5" y="282.0981">MyApp Server Launch</text><polygon fill="#A80036" points="1234.5,363.8281,1244.5,367.8281,1234.5,371.8281,1238.5,367.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="896.5" x2="1240.5" y1="367.8281" y2="367.8281"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="284" x="903.5" y="302.231">http://AuthServer.com/RegisterClient</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="903.5" y="317.3638">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="919.5" y="332.4966">app_name:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49" x="996.5" y="332.4966">MyApp</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1045.5" y="332.4966">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="919.5" y="347.6294">app_redirect_uri:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203" x="1031.5" y="347.6294">http://MyApp.com/CallBack</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="903.5" y="362.7622">}</text><polygon fill="#A80036" points="907.5,438.3594,897.5,442.3594,907.5,446.3594,903.5,442.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="901.5" x2="1250.5" y1="442.3594" y2="442.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="913.5" y="391.895">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="929.5" y="407.0278">client_id:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="990.5" y="407.0278">DEADFACE0123</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1105.5" y="407.0278">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="929.5" y="422.1606">client_secret:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="130" x="1019.5" y="422.1606">10102192040230</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="913.5" y="437.2935">}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="968" y="481.5698"/><rect fill="#EEEEEE" filter="url(#f1zkq0s83i0iy)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1723" x="0" y="518.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1723" y1="518.7305" y2="518.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1723" y1="521.7305" y2="521.7305"/><rect fill="#EEEEEE" filter="url(#f1zkq0s83i0iy)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="337" x="693" y="508.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="318" x="699" y="524.231">OAUTH 2.0 AUTHORIZATION_CODE TOKEN</text><polygon fill="#A80036" points="533.5,558.4297,543.5,562.4297,533.5,566.4297,537.5,562.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="349.5" x2="539.5" y1="562.4297" y2="562.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="356.5" y="557.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="369.5" y="557.3638">Click on Connect</text><polygon fill="#A80036" points="879.5,587.5625,889.5,591.5625,879.5,595.5625,883.5,591.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="555.5" x2="885.5" y1="591.5625" y2="591.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="562.5" y="586.4966">2</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180" x="575.5" y="586.4966">http://MyApp.com/Login</text><polygon fill="#A80036" points="566.5,732.4922,556.5,736.4922,566.5,740.4922,562.5,736.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="560.5" x2="895.5" y1="736.4922" y2="736.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="572.5" y="686.0278">3</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="43" x="584.5" y="640.6294">HTTP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="631.5" y="640.6294">302 Redirect to</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="85" x="733.5" y="640.6294">AuthServer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="822.5" y="640.6294"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="584.5" y="655.7622">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="600.5" y="670.895">client_id:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="661.5" y="670.895">DEADFACE0123</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="776.5" y="670.895">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="600.5" y="686.0278">scope:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="647.5" y="686.0278">CONTACTS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="730.5" y="686.0278">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="600.5" y="701.1606">response_type:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41" x="704.5" y="701.1606">CODE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="745.5" y="701.1606">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="600.5" y="716.2935">redirect_uri:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203" x="681.5" y="716.2935">http://MyApp.com/CallBack</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="584.5" y="731.4263">}</text><polygon fill="#A80036" points="1234.5,892.5547,1244.5,896.5547,1234.5,900.5547,1238.5,896.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="555.5" x2="1240.5" y1="896.5547" y2="896.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="562.5" y="838.5239">4</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="250" x="575.5" y="785.5591">http://AuthServer.com/Authorize</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="575.5" y="800.6919">Method:</text><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="631.5" y="800.6919">GET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="575.5" y="815.8247">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="591.5" y="830.9575">client_id:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="652.5" y="830.9575">DEADFACE0123</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="767.5" y="830.9575">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="591.5" y="846.0903">scope:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="638.5" y="846.0903">CONTACTS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="721.5" y="846.0903">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="591.5" y="861.2231">response_type:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41" x="695.5" y="861.2231">CODE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="736.5" y="861.2231">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="591.5" y="876.356">redirect_uri:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203" x="672.5" y="876.356">http://MyApp.com/CallBack</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="575.5" y="891.4888">}</text><path d="M109,814.8906 L109,854.8906 L536,854.8906 L536,824.8906 L526,814.8906 L109,814.8906 " fill="#FBFB77" filter="url(#f1zkq0s83i0iy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M526,814.8906 L526,824.8906 L536,824.8906 L526,814.8906 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108" x="115" y="831.9575">response type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="227" y="831.9575">: type of information client expects to receive</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="115" y="847.0903">scope</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="163" y="847.0903">: permissions the client is requesting for</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1303.5" y1="925.6875" y2="925.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1303.5" x2="1303.5" y1="925.6875" y2="938.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262.5" x2="1303.5" y1="938.6875" y2="938.6875"/><polygon fill="#A80036" points="1272.5,934.6875,1262.5,938.6875,1272.5,942.6875,1268.5,938.6875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1268.5" y="920.6216">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="1281.5" y="920.6216">ValidateAppID(</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="1376.5" y="920.6216">DEADFACE0123</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="1491.5" y="920.6216">)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1303.5" y1="997.8203" y2="997.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1303.5" x2="1303.5" y1="997.8203" y2="1010.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262.5" x2="1303.5" y1="1010.8203" y2="1010.8203"/><polygon fill="#A80036" points="1272.5,1006.8203,1262.5,1010.8203,1272.5,1014.8203,1268.5,1010.8203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1268.5" y="992.7544">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="1281.5" y="992.7544">Render Login Form</text><polygon fill="#A80036" points="566.5,1065.9531,556.5,1069.9531,566.5,1073.9531,562.5,1069.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="560.5" x2="1250.5" y1="1069.9531" y2="1069.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="572.5" y="1064.8872">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="585.5" y="1064.8872">Login Form</text><polygon fill="#A80036" points="365.5,1095.0859,355.5,1099.0859,365.5,1103.0859,361.5,1099.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="359.5" x2="544.5" y1="1099.0859" y2="1099.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="371.5" y="1094.02">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="384.5" y="1094.02">Login Form</text><line style="stroke:#A80036;stroke-width:1.0;" x1="359.5" x2="401.5" y1="1128.2188" y2="1128.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="401.5" x2="401.5" y1="1128.2188" y2="1141.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="360.5" x2="401.5" y1="1141.2188" y2="1141.2188"/><polygon fill="#A80036" points="370.5,1137.2188,360.5,1141.2188,370.5,1145.2188,366.5,1141.2188" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="366.5" y="1123.1528">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="379.5" y="1123.1528">Input Credentials</text><polygon fill="#A80036" points="533.5,1196.3516,543.5,1200.3516,533.5,1204.3516,537.5,1200.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349.5" x2="539.5" y1="1200.3516" y2="1200.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="356.5" y="1195.2856">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="379.5" y="1195.2856">Submit Form</text><polygon fill="#A80036" points="1234.5,1270.8828,1244.5,1274.8828,1234.5,1278.8828,1238.5,1274.8828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="555.5" x2="1240.5" y1="1274.8828" y2="1274.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="562.5" y="1247.1177">11</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="250" x="584.5" y="1224.4185">http://AuthServer.com/Authorize</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="838.5" y="1224.4185"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="584.5" y="1239.5513">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="600.5" y="1254.6841">credentials</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="584.5" y="1269.8169">}</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1303.5" y1="1304.0156" y2="1304.0156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1303.5" x2="1303.5" y1="1304.0156" y2="1317.0156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262.5" x2="1303.5" y1="1317.0156" y2="1317.0156"/><polygon fill="#A80036" points="1272.5,1313.0156,1262.5,1317.0156,1272.5,1321.0156,1268.5,1317.0156" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1268.5" y="1298.9497">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="1290.5" y="1298.9497">Render Consent Form for scope</text><polygon fill="#A80036" points="566.5,1417.5469,556.5,1421.5469,566.5,1425.5469,562.5,1421.5469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="560.5" x2="1250.5" y1="1421.5469" y2="1421.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="572.5" y="1393.7817">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="593.5" y="1371.0825">Consent Form</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="593.5" y="1386.2153">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="609.5" y="1401.3481">scope:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="656.5" y="1401.3481">CONTACTS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="743.5" y="1401.3481"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="593.5" y="1416.481">}</text><polygon fill="#A80036" points="365.5,1497.0781,355.5,1501.0781,365.5,1505.0781,361.5,1501.0781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="359.5" x2="544.5" y1="1501.0781" y2="1501.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="371.5" y="1473.313">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="393.5" y="1450.6138">Consent Form</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="393.5" y="1465.7466">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="409.5" y="1480.8794">scope:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="456.5" y="1480.8794">CONTACTS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="543.5" y="1480.8794"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="393.5" y="1496.0122">}</text><path d="M5,1434.5469 L5,1504.5469 L336,1504.5469 L336,1444.5469 L326,1434.5469 L5,1434.5469 " fill="#FBFB77" filter="url(#f1zkq0s83i0iy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M326,1434.5469 L326,1444.5469 L336,1444.5469 L326,1434.5469 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93" x="11" y="1451.6138">AuthServers</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="108" y="1451.6138">validates with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="34" x="201" y="1451.6138">User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="239" y="1451.6138">if the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="45" x="276" y="1451.6138">Scope</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="11" y="1466.7466">is acceptable and if the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="85" x="164" y="1466.7466">AuthServer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="253" y="1466.7466">can give</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="11" y="1481.8794">permission to the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93" x="127" y="1481.8794">ClientServer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="224" y="1481.8794">to access the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="11" y="1497.0122">resources in</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="119" x="93" y="1497.0122">ResourceServer</text><polygon fill="#A80036" points="533.5,1531.2109,543.5,1535.2109,533.5,1539.2109,537.5,1535.2109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349.5" x2="539.5" y1="1535.2109" y2="1535.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="356.5" y="1530.145">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="378.5" y="1530.145">Accept</text><polygon fill="#A80036" points="1234.5,1560.3438,1244.5,1564.3438,1234.5,1568.3438,1238.5,1564.3438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="555.5" x2="1240.5" y1="1564.3438" y2="1564.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="562.5" y="1559.2778">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="584.5" y="1559.2778">Accept</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1303.5" y1="1623.7422" y2="1623.7422"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1303.5" x2="1303.5" y1="1623.7422" y2="1636.7422"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262.5" x2="1303.5" y1="1636.7422" y2="1636.7422"/><polygon fill="#A80036" points="1272.5,1632.7422,1262.5,1636.7422,1272.5,1640.7422,1268.5,1636.7422" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1268.5" y="1603.5435">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="1290.5" y="1588.4106">Validate</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88" x="1346.5" y="1588.4106">redirect_uri</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="1434.5" y="1588.4106">, from this call,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="1290.5" y="1603.5435">matches</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122" x="1350.5" y="1603.5435">app_redirect_uri</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="1472.5" y="1603.5435">, from the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1290.5" y="1618.6763">registration.</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1303.5" y1="1695.875" y2="1695.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1303.5" x2="1303.5" y1="1695.875" y2="1708.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262.5" x2="1303.5" y1="1708.875" y2="1708.875"/><polygon fill="#A80036" points="1272.5,1704.875,1262.5,1708.875,1272.5,1712.875,1268.5,1708.875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1268.5" y="1690.8091">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="1290.5" y="1690.8091">generate code as per response_type</text><polygon fill="#A80036" points="566.5,1824.5391,556.5,1828.5391,566.5,1832.5391,562.5,1828.5391" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="560.5" x2="1250.5" y1="1828.5391" y2="1828.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="572.5" y="1793.2075">19</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="43" x="594.5" y="1762.9419">HTTP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="641.5" y="1762.9419">302 Redirect to</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203" x="743.5" y="1762.9419">http://MyApp.com/CallBack</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="594.5" y="1778.0747">Method:</text><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="650.5" y="1778.0747">GET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="594.5" y="1793.2075">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="610.5" y="1808.3403">CODE :</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="660.5" y="1808.3403">9807023480AC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="594.5" y="1823.4731">}</text><polygon fill="#A80036" points="879.5,1939.2031,889.5,1943.2031,879.5,1947.2031,883.5,1943.2031" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="555.5" x2="885.5" y1="1943.2031" y2="1943.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="562.5" y="1907.8716">20</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203" x="585.5" y="1877.606">http://MyApp.com/CallBack</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="585.5" y="1892.7388">Method:</text><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="641.5" y="1892.7388">GET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="585.5" y="1907.8716">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="601.5" y="1923.0044">code :</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="645.5" y="1923.0044">9807023480AC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="585.5" y="1938.1372">}</text><polygon fill="#A80036" points="1234.5,2089.3984,1244.5,2093.3984,1234.5,2097.3984,1238.5,2093.3984" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901.5" x2="1240.5" y1="2093.3984" y2="2093.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="908.5" y="2027.8013">21</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="930.5" y="1967.27">http://AuthServer.com/Tokens</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="930.5" y="1982.4028">Method:</text><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41" x="986.5" y="1982.4028">POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="930.5" y="1997.5356">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="946.5" y="2012.6685">code:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="986.5" y="2012.6685">9807023480AC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1098.5" y="2012.6685">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="946.5" y="2027.8013">client_id:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="1007.5" y="2027.8013">DEADFACE0123</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1122.5" y="2027.8013">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="946.5" y="2042.9341">client_secret:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="130" x="1036.5" y="2042.9341">10102192040230</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1166.5" y="2042.9341">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="946.5" y="2058.0669">grant_type:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="174" x="1025.5" y="2058.0669">AUTHORIZATION_CODE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1199.5" y="2058.0669">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="946.5" y="2073.1997">redirect_uri:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203" x="1027.5" y="2073.1997">http://MyApp.com/CallBack</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="930.5" y="2088.3325">}</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1303.5" y1="2122.5313" y2="2122.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1303.5" x2="1303.5" y1="2122.5313" y2="2135.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262.5" x2="1303.5" y1="2135.5313" y2="2135.5313"/><polygon fill="#A80036" points="1272.5,2131.5313,1262.5,2135.5313,1272.5,2139.5313,1268.5,2135.5313" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1268.5" y="2117.4653">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="1290.5" y="2117.4653">validate auth_code, client_id</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1303.5" y1="2224.9297" y2="2224.9297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1303.5" x2="1303.5" y1="2224.9297" y2="2237.9297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262.5" x2="1303.5" y1="2237.9297" y2="2237.9297"/><polygon fill="#A80036" points="1272.5,2233.9297,1262.5,2237.9297,1272.5,2241.9297,1268.5,2237.9297" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="1268.5" y="2204.731">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="1289.5" y="2189.5981">Validate</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88" x="1345.5" y="2189.5981">redirect_uri</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="1433.5" y="2189.5981">, from this call,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="1289.5" y="2204.731">matches</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122" x="1349.5" y="2204.731">app_redirect_uri</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="1471.5" y="2204.731">, from the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1289.5" y="2219.8638">registration.</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1303.5" y1="2310.6953" y2="2310.6953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1303.5" x2="1303.5" y1="2310.6953" y2="2323.6953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262.5" x2="1303.5" y1="2323.6953" y2="2323.6953"/><polygon fill="#A80036" points="1272.5,2319.6953,1262.5,2323.6953,1272.5,2327.6953,1268.5,2323.6953" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1268.5" y="2305.6294">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="1290.5" y="2305.6294">generate tokens</text><path d="M1407,2280.9297 L1407,2335.9297 L1609,2335.9297 L1609,2290.9297 L1599,2280.9297 L1407,2280.9297 " fill="#FBFB77" filter="url(#f1zkq0s83i0iy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1599,2280.9297 L1599,2290.9297 L1609,2290.9297 L1599,2280.9297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="1413" y="2297.9966">Embed the scope of access,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="1413" y="2313.1294">i.e., access level, in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="1413" y="2328.2622">access_tokens</text><polygon fill="#A80036" points="912.5,2495.8242,902.5,2499.8242,912.5,2503.8242,908.5,2499.8242" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="906.5" x2="1250.5" y1="2499.8242" y2="2499.8242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="918.5" y="2464.4927">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="940.5" y="2434.2271">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="956.5" y="2449.3599">access_token:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164" x="1052.5" y="2449.3599">DGF3DS90124FADS0U</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1216.5" y="2449.3599">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="956.5" y="2464.4927">refresh_token:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="146" x="1054.5" y="2464.4927">FGLAHG810324GAG</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1200.5" y="2464.4927">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="956.5" y="2479.6255">token_type:</text><text fill="#A52A2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="58" x="1037.5" y="2479.6255">BEARER</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="1099.5" y="2479.6255"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="940.5" y="2494.7583">}</text><path d="M501,2380.3281 L501,2541.3281 L882,2541.3281 L882,2390.3281 L872,2380.3281 L501,2380.3281 " fill="#FBFB77" filter="url(#f1zkq0s83i0iy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M872,2380.3281 L872,2390.3281 L882,2390.3281 L872,2380.3281 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109" x="507" y="2397.395">Bearer tokens</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="620" y="2397.395">are a much simpler way of making API</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="507" y="2412.5278">requests, since they don’t require cryptographic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300" x="507" y="2427.6606">signing of each request. The tradeoff is that all</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354" x="507" y="2442.7935">API requests must be made over an HTTPS connection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311" x="507" y="2457.9263">since the request contains a plaintext token that</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302" x="507" y="2473.0591">could be used by anyone if it were intercepted.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="511" y="2488.1919"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="507" y="2503.3247">The downside to</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109" x="617" y="2503.3247">Bearer tokens</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="730" y="2503.3247">is that there is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325" x="507" y="2518.4575">nothing preventing other apps from using a Bearer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="507" y="2533.5903">token if it can get access to it.</text><polygon fill="#A80036" points="1565.5,2638.1875,1575.5,2642.1875,1565.5,2646.1875,1569.5,2642.1875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901.5" x2="1571.5" y1="2642.1875" y2="2642.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="908.5" y="2614.4224">26</text><text fill="#A52A2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="930.5" y="2591.7231">http://ResourceServer.com/Contacts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="1214.5" y="2591.7231"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="930.5" y="2606.856">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="946.5" y="2621.9888">access_token:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164" x="1042.5" y="2621.9888">DGF3DS90124FADS0U</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="1210.5" y="2621.9888"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="930.5" y="2637.1216">}</text><polygon fill="#A80036" points="1267.5,2712.7188,1257.5,2716.7188,1267.5,2720.7188,1263.5,2716.7188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1576.5" y1="2716.7188" y2="2716.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1273.5" y="2688.9536">27</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="238" x="1295.5" y="2666.2544">http://AuthServer.com/Validate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="1537.5" y="2666.2544"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="1295.5" y="2681.3872">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="1311.5" y="2696.52">access_token:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164" x="1407.5" y="2696.52">DGF3DS90124FADS0U</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="1575.5" y="2696.52"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="1295.5" y="2711.6528">}</text><polygon fill="#A80036" points="1565.5,2741.8516,1575.5,2745.8516,1565.5,2749.8516,1569.5,2745.8516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1571.5" y1="2745.8516" y2="2745.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1258.5" y="2740.7856">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="1280.5" y="2740.7856">Success</text><polygon fill="#A80036" points="912.5,2770.9844,902.5,2774.9844,912.5,2778.9844,908.5,2774.9844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="906.5" x2="1581.5" y1="2774.9844" y2="2774.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="918.5" y="2769.9185">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="940.5" y="2769.9185">[ {contacts}, ... ]</text><polygon fill="#A80036" points="566.5,2800.1172,556.5,2804.1172,566.5,2808.1172,562.5,2804.1172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="560.5" x2="895.5" y1="2804.1172" y2="2804.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="572.5" y="2799.0513">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="594.5" y="2799.0513">Success</text><polygon fill="#A80036" points="360.5,2829.25,350.5,2833.25,360.5,2837.25,356.5,2833.25" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="354.5" x2="549.5" y1="2833.25" y2="2833.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="366.5" y="2828.1841">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="387.5" y="2828.1841">Success</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="47" x="1577" y="14.2822">Created:</text><text fill="#FF0000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="96" x="1627" y="14.2822">Jun-20-2021 20:20</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="187" x="1536" y="25.9229">View Generated: Jul-11-2021 01:41</text><!--MD5=[3652aa0a54f0d2e176368bdc1e61edb5]
@startuml
header
    Created: <font color=red>Jun-20-2021 20:20</font>
    View Generated: %date("MMM-dd-yyyy HH:mm")
endheader
title
    = [oauth 2.0] Authorization Code Grant flow (server to server)
    <size:11><i> User wants to expose all his contacts to "MyApp Server." </i></size>
    <size:11><i> "MyApp Server" presents a page with all possible resource servers </i></size>
    <size:11><i> (like GMail/FB). User chooses one of them. </i></size>
end title
autoactivate on

actor "User" as user <<Resource Owner>> #APPLICATION
participant "Web Browser" as browser <<User Agent>> #APPLICATION
participant "MyApp Server" as clientServer <<Client / Redirect URI>> #IMPLEMENTATION
participant "GMail/FB Server" as authServer <<Authorization Server>> #TECHNOLOGY
participant "Google Contacts API/FB Friends API" as resourceServer <<Resource Server>> #STRATEGY

== Client Registration ==
group #LightCyan MyApp Server Launch
    clientServer -> authServer : <font color=blue>**http://AuthServer.com/RegisterClient**</font>\n{\n    app_name: **MyApp**,\n    app_redirect_uri: <font color=red>**http://MyApp.com/CallBack**</font>\n}
    authServer - -> clientServer : {\n    client_id: **DEADFACE0123**,\n    client_secret: **10102192040230**\n}
end group

... ...

== OAUTH 2.0 AUTHORIZATION_CODE TOKEN ==
autonumber
user -> browser : Click on Connect
    browser -> clientServer : <font color=red>**http://MyApp.com/Login**</font>
    |||
    clientServer - -> browser : **HTTP** 302 Redirect to <font color=blue>**AuthServer**</font> \n{\n    client_id: **DEADFACE0123**,\n    scope: **CONTACTS**,\n    response_type: **CODE**,\n    redirect_uri: <font color=red>**http://MyApp.com/CallBack**</font>\n}

    |||
    browser -> authServer : <font color=blue>**http://AuthServer.com/Authorize**</font>\nMethod: <font color=green>**GET**</font>\n{\n    client_id: **DEADFACE0123**,\n    scope: **CONTACTS**,\n    response_type: **CODE**,\n    redirect_uri: <font color=red>**http://MyApp.com/CallBack**</font>\n}
    note left
        **response type** : type of information client expects to receive
        **scope** : permissions the client is requesting for
    end note

        authServer -> authServer : ValidateAppID(**DEADFACE0123**)
        deactivate authServer
        authServer -> authServer : Render Login Form
        deactivate authServer
    authServer - -> browser : Login Form
    browser -> user : Login Form
        user -> user : Input Credentials
        deactivate user
    user - -> browser : Submit Form

    browser -> authServer : <font color=blue>**http://AuthServer.com/Authorize**</font> \n{\n    credentials \n}
        authServer -> authServer : Render Consent Form for scope
        deactivate authServer
    authServer - -> browser : Consent Form\n{\n    scope: **CONTACTS** \n}
    browser -> user : Consent Form\n{\n    scope: **CONTACTS** \n}
    note left
        **AuthServers** validates with **User** if the **Scope**
        is acceptable and if the **AuthServer** can give
        permission to the **ClientServer** to access the
        resources in **ResourceServer**
    end note
    user - -> browser : Accept
    browser -> authServer : Accept
        authServer -> authServer : Validate **redirect_uri**, from this call,\nmatches **app_redirect_uri**, from the\nregistration.
        deactivate authServer
        authServer -> authServer : generate code as per response_type
        deactivate authServer
    authServer - -> browser : **HTTP** 302 Redirect to <font color=red>**http://MyApp.com/CallBack**</font>\nMethod: <font color=green>**GET**</font>\n{\n    CODE : **9807023480AC**\n}

    |||
    browser -> clientServer : <font color=red>**http://MyApp.com/CallBack**</font>\nMethod: <font color=green>**GET**</font>\n{\n    code : **9807023480AC**\n}
        clientServer -> authServer : <font color=blue>**http://AuthServer.com/Tokens**</font>\nMethod: <font color=green>**POST**</font>\n{\n    code: **9807023480AC**,\n    client_id: **DEADFACE0123**,\n    client_secret: **10102192040230**,\n    grant_type: **AUTHORIZATION_CODE**,\n    redirect_uri: <font color=red>**http://MyApp.com/CallBack**</font>\n}
            authServer -> authServer : validate auth_code, client_id
            deactivate authServer
            authServer -> authServer : Validate **redirect_uri**, from this call,\nmatches **app_redirect_uri**, from the\nregistration.
            deactivate authServer
            authServer -> authServer : generate tokens
            note right
                Embed the scope of access,
                i.e., access level, in the
                access_tokens
            end note
            deactivate authServer
        authServer - -> clientServer : {\n    access_token: **DGF3DS90124FADS0U**,\n    refresh_token: **FGLAHG810324GAG**,\n    token_type: <font color=brown>**BEARER**</font> \n}
        note left
            <b>Bearer tokens</b> are a much simpler way of making API
            requests, since they don’t require cryptographic
            signing of each request. The tradeoff is that all
            API requests must be made over an HTTPS connection,
            since the request contains a plaintext token that
            could be used by anyone if it were intercepted.

            The downside to <b>Bearer tokens</b> is that there is
            nothing preventing other apps from using a Bearer
            token if it can get access to it. 
        end note

        |||
        clientServer -> resourceServer : <font color=brown>**http://ResourceServer.com/Contacts**</font> \n{\n    access_token: **DGF3DS90124FADS0U** \n}
            resourceServer -> authServer : <font color=blue>**http://AuthServer.com/Validate**</font> \n{\n    access_token: **DGF3DS90124FADS0U** \n}
            authServer - -> resourceServer : Success
        resourceServer - -> clientServer : [ {contacts}, ... ]
    clientServer - -> browser : Success
browser - -> user : Success
@enduml

@startuml
header
    Created: <font color=red>Jun-20-2021 20:20</font>
    View Generated: Jul-11-2021 01:41
endheader
title
    = [oauth 2.0] Authorization Code Grant flow (server to server)
    <size:11><i> User wants to expose all his contacts to "MyApp Server." </i></size>
    <size:11><i> "MyApp Server" presents a page with all possible resource servers </i></size>
    <size:11><i> (like GMail/FB). User chooses one of them. </i></size>
end title
autoactivate on

actor "User" as user <<Resource Owner>> #APPLICATION
participant "Web Browser" as browser <<User Agent>> #APPLICATION
participant "MyApp Server" as clientServer <<Client / Redirect URI>> #IMPLEMENTATION
participant "GMail/FB Server" as authServer <<Authorization Server>> #TECHNOLOGY
participant "Google Contacts API/FB Friends API" as resourceServer <<Resource Server>> #STRATEGY

== Client Registration ==
group #LightCyan MyApp Server Launch
    clientServer -> authServer : <font color=blue>**http://AuthServer.com/RegisterClient**</font>\n{\n    app_name: **MyApp**,\n    app_redirect_uri: <font color=red>**http://MyApp.com/CallBack**</font>\n}
    authServer - -> clientServer : {\n    client_id: **DEADFACE0123**,\n    client_secret: **10102192040230**\n}
end group

... ...

== OAUTH 2.0 AUTHORIZATION_CODE TOKEN ==
autonumber
user -> browser : Click on Connect
    browser -> clientServer : <font color=red>**http://MyApp.com/Login**</font>
    |||
    clientServer - -> browser : **HTTP** 302 Redirect to <font color=blue>**AuthServer**</font> \n{\n    client_id: **DEADFACE0123**,\n    scope: **CONTACTS**,\n    response_type: **CODE**,\n    redirect_uri: <font color=red>**http://MyApp.com/CallBack**</font>\n}

    |||
    browser -> authServer : <font color=blue>**http://AuthServer.com/Authorize**</font>\nMethod: <font color=green>**GET**</font>\n{\n    client_id: **DEADFACE0123**,\n    scope: **CONTACTS**,\n    response_type: **CODE**,\n    redirect_uri: <font color=red>**http://MyApp.com/CallBack**</font>\n}
    note left
        **response type** : type of information client expects to receive
        **scope** : permissions the client is requesting for
    end note

        authServer -> authServer : ValidateAppID(**DEADFACE0123**)
        deactivate authServer
        authServer -> authServer : Render Login Form
        deactivate authServer
    authServer - -> browser : Login Form
    browser -> user : Login Form
        user -> user : Input Credentials
        deactivate user
    user - -> browser : Submit Form

    browser -> authServer : <font color=blue>**http://AuthServer.com/Authorize**</font> \n{\n    credentials \n}
        authServer -> authServer : Render Consent Form for scope
        deactivate authServer
    authServer - -> browser : Consent Form\n{\n    scope: **CONTACTS** \n}
    browser -> user : Consent Form\n{\n    scope: **CONTACTS** \n}
    note left
        **AuthServers** validates with **User** if the **Scope**
        is acceptable and if the **AuthServer** can give
        permission to the **ClientServer** to access the
        resources in **ResourceServer**
    end note
    user - -> browser : Accept
    browser -> authServer : Accept
        authServer -> authServer : Validate **redirect_uri**, from this call,\nmatches **app_redirect_uri**, from the\nregistration.
        deactivate authServer
        authServer -> authServer : generate code as per response_type
        deactivate authServer
    authServer - -> browser : **HTTP** 302 Redirect to <font color=red>**http://MyApp.com/CallBack**</font>\nMethod: <font color=green>**GET**</font>\n{\n    CODE : **9807023480AC**\n}

    |||
    browser -> clientServer : <font color=red>**http://MyApp.com/CallBack**</font>\nMethod: <font color=green>**GET**</font>\n{\n    code : **9807023480AC**\n}
        clientServer -> authServer : <font color=blue>**http://AuthServer.com/Tokens**</font>\nMethod: <font color=green>**POST**</font>\n{\n    code: **9807023480AC**,\n    client_id: **DEADFACE0123**,\n    client_secret: **10102192040230**,\n    grant_type: **AUTHORIZATION_CODE**,\n    redirect_uri: <font color=red>**http://MyApp.com/CallBack**</font>\n}
            authServer -> authServer : validate auth_code, client_id
            deactivate authServer
            authServer -> authServer : Validate **redirect_uri**, from this call,\nmatches **app_redirect_uri**, from the\nregistration.
            deactivate authServer
            authServer -> authServer : generate tokens
            note right
                Embed the scope of access,
                i.e., access level, in the
                access_tokens
            end note
            deactivate authServer
        authServer - -> clientServer : {\n    access_token: **DGF3DS90124FADS0U**,\n    refresh_token: **FGLAHG810324GAG**,\n    token_type: <font color=brown>**BEARER**</font> \n}
        note left
            <b>Bearer tokens</b> are a much simpler way of making API
            requests, since they don’t require cryptographic
            signing of each request. The tradeoff is that all
            API requests must be made over an HTTPS connection,
            since the request contains a plaintext token that
            could be used by anyone if it were intercepted.

            The downside to <b>Bearer tokens</b> is that there is
            nothing preventing other apps from using a Bearer
            token if it can get access to it. 
        end note

        |||
        clientServer -> resourceServer : <font color=brown>**http://ResourceServer.com/Contacts**</font> \n{\n    access_token: **DGF3DS90124FADS0U** \n}
            resourceServer -> authServer : <font color=blue>**http://AuthServer.com/Validate**</font> \n{\n    access_token: **DGF3DS90124FADS0U** \n}
            authServer - -> resourceServer : Success
        resourceServer - -> clientServer : [ {contacts}, ... ]
    clientServer - -> browser : Success
browser - -> user : Success
@enduml

PlantUML version 1.2021.9beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>